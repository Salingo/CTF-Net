# CTF-Net
[TVCG 2021] Consistent Two-Flow Network for Tele-Registration of Point Clouds

![overview](./doc/overview.png)


### Introduction

We present a learning-based technique that allows registration between point clouds presented in arbitrary poses, and having little or even no overlap, a setting that has been referred to as *tele-registration*.

Our technique is based on a novel neural network design that learns a prior of a class of shapes and can complete a partial shape. The key idea is combining the registration and completion tasks in a way that reinforces each other. In particular, we simultaneously train the registration network and completion network using two coupled flows, one that *register-and-complete*, and one that *complete-and-register*, and encourage the two flows to produce a consistent result.

For more details, please refer to our [project page](https://vcc.tech/research/2021/CTFNet).

![network](./doc/network.png)


### Dataset

The training data are generated by virtual scanning and sphere cropping.

Specifically, given a mesh model, the point cloud data is first obtained by [virtual scanning](https://github.com/Salingo/virtual-3d-scanner), then, the partial point cloud pair is generated by random sphere cropping (see `crop_pc.py` in `data` folder). Finally, all the data are organized in HDF5 format (see `create_h5.py` in `data` folder).
In our implementation, we select 8 categories in the ShapeNet v2 dataset to create our training data, the train/validate/test list is provided in `data` folder.


### Usage

The codes are tested under PyTorch 1.7.0 GPU version and Python 3.7 on Linux Mint 20.

First, please install the [EMD module](https://github.com/Colin97/MSN-Point-Cloud-Completion/tree/master/emd).

Run `train.py` to train CTF-Net, the trained models will be saved in `CTF-Net/output/` folder.

Run `test.py` to test the trained models.


### License

Our code is released under MIT License. See LICENSE file for details.


### Citation

Please cite the paper in your publications if it helps your research:
```
@article{CTFNet21,
title={Consistent Two-Flow Network for Tele-Registration of Point Clouds},
author={Zihao Yan and Zimu Yi and Ruizhen Hu and Niloy J. Mitra and Daniel Cohen-Or and Hui Huang},
journal={IEEE Transactions on Visualization and Computer Graphics},
volume={},
pages={},
year={2021},
doi={10.1109/TVCG.2021.3086113}
}
```
